# Common

### **データベース(Database)**
データを決まった規則で格納し効率良く読み書きができる様にしたもの</br>
リレーショナル型が主流

</br>

### **SQL**
SQL(Structured Query Language: 構造化問い合わせ言語)</br>
IOS, JISなどで標準規格化されたリレーショナルDBを操作するための言語
- DDL(data definition language) : 表などのデータベースオブジェクトを削除・変更・作成する
  - CREATE : オブジェクトの作成
  - ALTER : オブジェクトの定義の変更
  - DROP : オブジェクトの削除
  - RENAME : オブジェクトの名前変更
  - TRANCATE : 表のレコードの全削除
  - COMMENT : コメントの定義
- DML(Data Manipulation Language) : 表内のデータ直接操作する
  - SELECT : データの取り出し
  - INSERT : データの挿入
  - UPDATE : データの更新
  - DELETE : データの削除
  - MARGE : データのマージ
- DCL(Data Control Language) : データベースに対しての権限付与・取り消し
  - GRANT : 権限の付与
  - REVOKE : 権限の取り消し
- トランザクション制御 : COMMIT, ROLLBACKなどのこと
  - COMMIT : 変更の確定
  - ROLLBACK : 変更の取り消し
  - SAVEPOINT : セーブポイントの作成

</br>

### **スキーマ(schema)**

</br>

### **表(Table)**
データを格納する入れ物、行(Row)・列(Column)形式で格納される</br>
通常複数テーブルに分割され、関連付け(Relational)は表のデータを使って行われる

</br>

### **マスターテーブル**

頻繁に変更しないデータを格納するテーブル</br>
例　部署、役職、支店番号

</br>

### **トランザクションテーブル**
頻繁に変更される日々の記録が格納されたテーブル
例　注文、勤怠

</br>

### **中間テーブル**
多対多の関係を持つテーブルを結びつけるためのテーブル</br>

例　
|StudentID|StudentName|CourseA|CourseB|CourseC|
|---|---|---|---|---|
1|summer oil|math|english|science

上記のテーブルだと、科目が増えるたびに列を追加しなければならない</br>
中間テーブルを使うと以下の様になる

|StudentID|StudentName|
|---|---|
1|summer oil

|CourseID|CourseName|
|---|---|
1|math

|id|StudentID|CourseID|
|---|---|---|
1|1|1

上記の様に中間テーブルを使うことで、科目が増えても列を追加する必要がなくなる

</br>

### **主キー**
データベースのデータ（行、レコード）を一意に識別するための項目
１列のみ設定できる、空にしてはいけない

</br>

### **複合主キー(複合キー)**
複数の行で作成する主キー

</br>

### **サロゲートキー**
主キーとして使われ、対象のデータとは直接関係しない、意味を持たない項目</br>
機械的に採番されたものなどが該当

</br>

### **外部キー**
別のテーブルのデータを格納することで別テーブルと関係を持たせることができるもの</br>
その関係上、関係を持たせたいテーブルに存在しないデータは設定できない(制約)
Nullを設定することができる

</br>

### **ユニークキー(ユニーク制約)**
複数行設定できる、設定した列の重複を排除できる

</br>

### **正規化**
データを使いやすいように整形すること

</br>

### **非正規化**
以下の様な理由からあえて正規化しない様にすること
・正規化でテーブル結合をしてしまうと膨大になってしまう場合
・過去のトランザクションに影響を与えたくない場合

</br>

### **トランザクション(トランザクション処理)**
複数のデータベースの値を変更する際に(例えばAテーブルから商品数マイナス、Bテーブルの商品数プラスなど)整合性を保つための仕組み
BEGIN TRANSACTION  -> SQL  -> COMMIT
SQL部で障害が起きた場合はROLLBACKで処理をキャンセル

</br>


### **ロック**
データベースの処理中に割り込んでこない様にするためのもの

</br>

#### **占有ロック**
他のユーザが読み込みもできない様にしてしまうこと

</br>

#### **共有ロック**
他のユーザは読み込みはできるが書き込みができない

</br>

#### **デットロック**
お互いがデータをロックしようとして、ロック解除待ち状態になり処理が止まること

</br>

#### **悲観ロック**
操作中だれにも触らせない様にして終わったら解放すること

</br>

#### **楽観ロック**
処理結果を更新するタイミングでだれも更新してないことを確認、
更新していた場合は処理結果を破棄

</br>




### **副問合せ**
SQLを入れ子で書くことが出来る機能</br>

```
--給料がJonathanよりも多い社員の選択

SELECT empno, empname, 
FROM employees
WHERE empsal > (SELECT sal FROM employees WHERE empname='Jonathan’)
```

### **リテラル**
SQL上にべた書きされた文字・数値・日付のこと












### 参考
- https://sowel.co.jp/PDF_file/SQL/Other/DB_GeneralTerm.pdf
